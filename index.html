<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ANTICEO</title>
  <style>
    body{background:#fff;color:#000;font-family:Georgia,serif;max-width:1200px;margin:0 auto;padding:8px 12px;}
    header{margin:8px 0 12px}
    header h1{font-size:2rem;text-align:center;margin:10px 0}
    header h1 a{color:#000;text-decoration:none}
    #news-columns{display:grid;grid-template-columns:1fr;gap:12px}
    @media (min-width:1024px){#news-columns{grid-template-columns:1fr 1fr 1fr}}
    ul{list-style:none;margin:0;padding:0}
    li{margin:6px 0;line-height:1.3}
    a{text-decoration:underline;color:#000}
    a:hover{text-decoration:none}
    .source{opacity:.6}
    footer{margin:24px 0 8px;font-size:.85rem;opacity:.7;text-align:center}
  </style>
</head>
<body>
  <header id="headline"><h1>ANTICEO</h1><hr></header>
  <main id="news-columns"></main>
  <footer>Updated automatically by ANTICEO Orange Pi</footer>

  <script>
    const DATA_URL = "./anticeo-news.json";
    const big = s => s ? s.toUpperCase() : s;

    fetch(DATA_URL + "?t=" + Date.now())
      .then(r => r.json())
      .then(data => {
        if (data.headline?.title && data.headline?.url) {
          document.getElementById("headline").innerHTML =
            `<h1><a href="${data.headline.url}" rel="noopener">${big(data.headline.title)}</a></h1><hr>`;
        }
        const cols = document.getElementById("news-columns");
        const colCount = getComputedStyle(cols).gridTemplateColumns.split(" ").length;
        const perCol = Math.ceil(data.items.length / colCount);
        for (let i = 0; i < data.items.length; i += perCol) {
          const group = data.items.slice(i, i + perCol);
          const ul = document.createElement("ul");
          group.forEach(it => {
            const li = document.createElement("li");
            li.innerHTML = `<a href="${it.url}" rel="noopener">${it.title}</a>` +
              (it.source ? ` <span class="source">(${it.source})</span>` : "");
            ul.appendChild(li);
          });
          cols.appendChild(ul);
        }
      })
      .catch(e => {
        document.getElementById("news-columns").innerHTML = "<p>Feed unavailable.</p>";
        console.error(e);
      });
  </script>
</body>
</html>
